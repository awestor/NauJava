<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Product List</title>
    <link rel="stylesheet" href="/css/products.css">
</head>
<body>
<a href="/view/products/" class="back-link">‚Üê Back to Home</a>

<div class="header-container">
    <h1>Product List</h1>
    <a href="/view/products/createForm" class="create-btn">Create New Product</a>
</div>

<table id="productsTable">
    <thead>
    <tr>
        <th data-sort="id">
            <span class="th-content">ID</span>
        </th>
        <th data-sort="name">
            <span class="th-content">Name</span>
        </th>
        <th data-sort="calories">
            <span class="th-content">Calories (per 100g)</span>
        </th>
        <th data-sort="proteins">
            <span class="th-content">Proteins</span>
        </th>
        <th data-sort="fats">
            <span class="th-content">Fats</span>
        </th>
        <th data-sort="carbs">
            <span class="th-content">Carbs</span>
        </th>
        <th data-sort="createdBy">
            <span class="th-content">Created By</span>
        </th>
        <th class="actions-header">
            <span class="th-content">Actions</span>
        </th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="product : ${products}">
        <td th:text="${product.id}"></td>
        <td th:text="${product.name}"></td>
        <td th:text="${product.caloriesPer100g} + ' kcal'"></td>
        <td th:text="${product.proteinsPer100g} + ' g'"></td>
        <td th:text="${product.fatsPer100g} + ' g'"></td>
        <td th:text="${product.carbsPer100g} + ' g'"></td>
        <td>
            <span th:if="${product.createdByUser == null}">System</span>
            <span th:if="${product.createdByUser != null}"
                  th:text="${product.createdByUser.login}"></span>
        </td>
        <td class="actions">
            <div class="btnDiv" th:if="${product.createdByUser != null}">
                <a th:href="@{/view/products/edit{id}(id=${product.id})}" class="btn btn-edit" title="Edit">
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwYXRoIGQ9Ik0xMSA0SDRhMiAyIDAgMCAwLTIgMnYxNGEyIDIgMCAwIDAgMiAyaDE0YTIgMiAwIDAgMCAyLTJ2LTciPjwvcGF0aD48cGF0aCBkPSJNMTguNSAyLjVhMi4xMjEgMi4xMjEgMCAwIDEgMyAzTDEyIDE1bC00IDEgMS00IDkuNS05LjV6Ij48L3BhdGg+PC9zdmc+" alt="Edit">
                </a>
                <button th:data-id="${product.id}" class="btn btn-delete" title="Delete">
                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiPjxwb2x5bGluZSBwb2ludHM9IjMgNiA1IDYgMjEgNiI+PC9wb2x5bGluZT48cGF0aCBkPSJNMTkgNnYxNGEyIDIgMCAwIDEtMiAySDdhMiAyIDAgMCAxLTItMlY2bTMgMFY0YTIgMiAwIDAgMSAyLTJoNGEyIDIgMCAwIDEgMiAydjIiPjwvcGF0aD48L3N2Zz4=" alt="Delete">
                </button>
            </div>
            <div class="no-actions" th:if="${product.createdByUser == null}">
                <span>-</span>
            </div>
        </td>
    </tr>
    </tbody>
</table>

<div class="stats">
    <p><strong>Total Products:</strong> <span id="totalCount" th:text="${#lists.size(products)}"></span></p>
    <p>
        <strong>System Products:</strong>
        <span id="systemCount" th:text="${systemCount}"></span> |
        <strong>User Products:</strong>
        <span id="userCount" th:text="${userCount}"></span>
    </p>
</div>

<script src="/js/products.js"></script>
</body>
</html>